这份文档汇总了之前的讨论，并加入了最新的“老师评语（Teacher Comments）”需求。

这是一个可以直接发给产品经理、后端和前端开发的 **PRD（产品需求文档）**。

---

# 教材管理与体验课报告生成逻辑 (MVP v1.0)

## 1. 项目背景与目标

为了快速响应运营需求，第一期“教材管理”功能不开发复杂的前端配置页面，而是采用 **“线下维护 Excel -> 后台上传解析”** 的模式。
核心目标是实现报告内容的**高度配置化**，支持不同类型教材（如考试类/口语类）展示不同的报告结构和文案。

## 2. 角色与流程

* **管理员：** 维护 Excel 模板，上传/更新教材。
* **老师：** 在后台进行学员评估时，除了勾选题目对错，还需完成“定级”和“评语选择”。
* **学生/家长：** 查看生成的 H5 报告。

---

## 3. 核心逻辑与数据结构

所有业务逻辑均由 Excel 定义。一个 Excel 文件对应一本教材。

### 3.1 报告的五大核心模块逻辑

| 模块名称 | 逻辑来源 | 变更点说明 |
| --- | --- | --- |
| **1. 技能雷达图** | **Excel 题目表的前 5 题** | 逻辑不变。系统默认读取 Sheet 2 的第 1-5 行作为雷达图维度。 |
| **2. 今日所学**<br>

<br>(Vocab/Sentences) | **Excel Sheet 3 (动态配置)** | **完全动态化**。不再写死“单词”和“句子”两个标题。前端根据 Excel 返回的列表渲染（支持 1-N 个模块）。 |
| **3. 成长全景图**<br>

<br>(Growth Panorama) | **老师手动选择 + Excel Sheet 4** | **改为人工定级**。老师在录入时做一道“定级题”，系统根据选项去 Sheet 4 匹配对应的“考试版”或“口语版”文案。 |
| **4. 老师评语**<br>

<br>(Teacher Comments) | **老师手动选择 + Excel Sheet 5** | **新增需求**。老师在录入时做一道“评语选择题”，系统根据选项去 Sheet 5 匹配预设的长评语。 |
| **5. 教材基础信息** | **Excel Sheet 1** | 包含教材 ID、名称、类型（考试/口语/其他）。 |

---

## 4. Excel 模板详细设计 (Schema)

开发请严格按照以下 Sheet 结构编写解析脚本。

### Sheet 1: 教材基础信息 (Basic Info)

*读取第 2 行数据（第 1 行为表头）。*

| 列名 (Key) | 必填 | 说明 | 示例 |
| --- | --- | --- | --- |
| **Book_ID** | 是 | 唯一标识，更新教材靠此字段 | `TB-ENG-L1` |
| **教材名称** | 是 | 展示在后台和报告页 | `剑桥少儿英语 Pre-A1` |
| **教材类型** | 是 | 用于后台筛选及统计 | `口语类` 或 `考试类` |
| **封面图** | 否 | URL 链接 | `https://.../cover.png` |

### Sheet 2: 题目与录入项配置 (Questions)

*这是老师在后台看到的“录入表单”结构。*

| 行号 | 题目ID | 题目内容/录入项名称 | 题目类型 | 关联维度/标识 | 选项配置 |
| --- | --- | --- | --- | --- | --- |
| **1-5** | Q1..Q5 | (雷达图维度名，如：发音) | **打分题** | **Radar** | (1-5分) |
| **6-N** | Q6.. | (具体练习题) | 单选/多选 | - | A/B/C/D |
| **N+1** | **STAGE** | **请选择学员当前阶段** | **单选** | **Growth_Trigger** | A. 起步 / B. 进阶... |
| **N+2** | **COMMENT** | **请选择老师总评** | **单选** | **Comment_Trigger** | A. 表现极佳 / B. 需鼓励... |

* **开发注意：**
* 解析时需识别标识 `Radar` (前5行)、`Growth_Trigger` (定级题)、`Comment_Trigger` (评语题)。
* 最后两道题（N+1, N+2）仅用于老师录入，**不计入学生总分**，仅用于触发后续逻辑。



### Sheet 3: 今日所学动态模块 (Dynamic Modules)

*用于渲染报告中间的内容区域。*

| 模块标题 (Title) | 模块内容 (Content) | 排序 (Sort) |
| --- | --- | --- |
| **🧠 Vocabulary Focus** | Apple, Banana, Cat<br>

<br>Dog, Elephant | 1 |
| **⚡️ Core Sentences** | - How are you?<br>

<br>- I'm fine, thank you. | 2 |
| **🎯 Grammar Tip** | (可选的其他模块，如有) | 3 |

### Sheet 4: 成长全景图规则 (Growth Rules)

*对应 Sheet 2 中 `STAGE` 题的选项。*

| 选项 Key | 阶段名称 (Stage Name) | 报告展示文案 (Display Text) | 坐标点 (Position) |
| --- | --- | --- | --- |
| **A** | 兴趣萌芽期 | (口语版)：宝贝敢于开口，互动积极...<br>

<br>(考试版)：基础知识点需加强记忆... | 1 |
| **B** | 习惯养成期 | ... | 3 |
| **C** | 能力爆发期 | ... | 5 |

### Sheet 5: 老师评语库 (Comment Rules)

*对应 Sheet 2 中 `COMMENT` 题的选项。*

| 选项 Key | 评语摘要 (仅管理员看) | 报告展示完整评语 (Full Text) |
| --- | --- | --- |
| **A** | 优秀-通用 | 这节课表现非常棒！能够快速理解老师的指令，发音清晰... |
| **B** | 良好-需提升自信 | 宝贝这节课有些害羞，但其实基础不错，建议回家多听多读... |
| **C** | 基础薄弱-建议复习 | 能够看出来宝贝很努力，但部分单词发音还需要纠正... |

---

## 5. 开发需求详述

### 5.1 后端开发任务 (Backend)

1. **数据库变更：**
* 建立教材主表、题目表（含类型标识）。
* 建立 `Knowledge_Modules` 表（存储 Sheet 3）。
* 建立 `Logic_Mapping` 表（存储 Sheet 4 和 Sheet 5 的 选项->文案 映射关系）。


2. **上传接口：** 实现 Excel 解析与全量覆盖更新（Upsert）。
3. **报告生成接口 (`/api/report/detail`)：**
* **Sections:** 返回动态数组，包含 Sheet 3 定义的 Title 和 Content。
* **Growth:** 根据老师选的 `STAGE` 选项，返回 Sheet 4 对应的 `Stage Name`, `Text`, `Position`。
* **Comment:** 根据老师选的 `COMMENT` 选项，返回 Sheet 5 对应的 `Full Text`。



### 5.2 前端开发任务 (Frontend)

1. **老师录入端：**
* 动态渲染题目列表。
* **关键点：** 确保最后两道“选择题”能正常显示，供老师进行单选操作。


2. **学生报告端 (H5)：**
* **今日所学区域：** 改为遍历渲染（`v-for`），不要写死 "Vocabulary" 标题。
* **全景图区域：** 展示接口返回的文案。
* **底部评语区域：** 展示接口返回的评语文字。



### 5.3 运营/管理员操作SOP

1. 在 Excel 中整理好题目、知识点、对应的不同文案。
2. 上传 Excel。
3. 系统校验格式，提示成功。
4. 老师在上课后，看到更新后的录入表单。

---

## 6. 验收标准 (Acceptance Criteria)

1. **灵活性验证：** 修改 Excel 中的 "Vocabulary Focus" 为 "Key Words"，重新上传后，报告页标题应立即变更。
2. **多教材验证：** 分别上传一本“口语书”和一本“考试书”。老师在录入时同样选“A. 起步阶段”，报告中展示的文案应完全不同（符合各自 Excel Sheet 4 的定义）。
3. **评语验证：** 老师选择评语 B，报告底部应准确显示 B 对应的长文案。